#pragma config(Sensor, S1,     touch,          sensorEV3_Touch)
#pragma config(Sensor, S2,     color,          sensorEV3_Color)
#pragma config(Sensor, S3,     angle,          sensorEV3_Gyro)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

void lineFollower(int target, float multiplier);
void stopMotors();
void lfToBlack(int threshold);
void turnDeg(int deg);

//Main program
task main()
{
	wait1Msec(5000);
	turnDeg(90);
}

//Line following
void lineFollower(int target, float multiplier){
	string t1;
	int col1 = getColorReflected(S2);
	sprintf(t1,"farve: %d", col1);
	displayCenteredBigTextLine(1,t1);

	int error = col1 - target;
	float difSpeed = error * multiplier;

	setMotorSync(motorA, motorB, difSpeed, 50);
}

//Follow the line until black marker
void lfToBlack(int threshold){
	while(getColorReflected(S2) > threshold){
		//Values for following the yellow lines
		lineFollower(40, 0.7);
	}
	stopMotors();
}

void turnDeg(int deg){
	resetGyro(S3);
	int meas = getGyroHeading(S3);
	while( meas < deg){

		setMotorSync(motorA, motorB, 100, 5);
		string t1;
		sprintf(t1,"Turn: %d", meas);
		displayCenteredBigTextLine(1,t1);
		meas = getGyroHeading(S3);
	}
	stopMotors();
}

//Stop motors
void stopMotors(){
	setMotorSync(motorA, motorB, 0, 0);
}
